import{l as D,m as Y,r as d,a as ee,u as oe,j as e,B as te,U as E,X as H,k as b}from"./index-CJnD_gLK.js";import{P as ae}from"./plus-BHj-BRdV.js";import{P as se}from"./play-DR7O6Dd6.js";import{S as re}from"./square-pen-DwoAyZhr.js";import{T as ne}from"./trash-2-BWDTMKj5.js";import{S as ie}from"./save-D0EATYqx.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],U=D("user-check",le);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],de=D("user-x",ce);function pe(){const{addWebhook:W}=Y(),[C,f]=d.useState([]),[_,M]=d.useState([]),[u,N]=d.useState([]),[j,k]=d.useState(!1),[L,v]=d.useState(!1),[S,n]=d.useState(!1),[q,R]=d.useState(!1),[x,w]=d.useState(null),[p,T]=d.useState(null),[t,r]=d.useState({nome:"",workflow_id:"",webhook_url:"",descricao:"",icone:"ğŸ¤–",cor:"bg-blue-500",ativo:!0}),i=ee(o=>o.push),{userData:m}=oe();async function c(){k(!0);try{console.log("ğŸ”„ REFRESH: Carregando agentes via webhook...");const o=await b("webhook/list-agentes",{method:"GET"});if(console.log("ğŸ”„ REFRESH: Resposta completa do webhook:",o),console.log("ğŸ”„ REFRESH: Tipo da resposta:",typeof o),console.log("ğŸ”„ REFRESH: response.data:",o.data),o.data&&Array.isArray(o.data)&&o.data.length>0&&o.data[0].success&&Array.isArray(o.data[0].data)&&o.data[0].data.length>0){console.log("ğŸ” Dados encontrados:",o.data),console.log("ğŸ” Processando agentes do formato correto:",o.data[0].data);const s=o.data[0].data.map(a=>({id:a.id,nome:a.nome,workflow_id:a.workflow_start_id||a.workflow_id,webhook_url:a.webhook_start_url||a.webhook_url,descricao:a.descricao,icone:a.icone,cor:a.cor,ativo:a.ativo,usuario_id:a.usuario_id,status_atual:a.status_atual,execution_id_ativo:a.execution_id_ativo}));console.log("ğŸ” Agentes processados:",s),f(s),i({kind:"success",message:`${s.length} agentes carregados com sucesso!`})}else if(o.data&&o.data!==""&&o.data.success&&Array.isArray(o.data.data)){console.log("ğŸ” Formato objeto com data array detectado:",o.data.data);const s=o.data.data.map(a=>(console.log("ğŸ” Processando agente (formato data array):",a),{id:a.id,nome:a.nome,workflow_id:a.workflow_id,webhook_url:a.webhook_url,descricao:a.descricao,icone:a.icone,cor:a.cor,ativo:a.ativo}));console.log("ğŸ” Agentes processados (formato data array):",s),f(s),i({kind:"success",message:`${s.length} agentes carregados com sucesso!`})}else console.log("ğŸ” Resposta vazia ou formato nÃ£o reconhecido, lista vazia"),f([]),o.data&&o.data!==""?(console.log("âš ï¸ Formato de resposta nÃ£o reconhecido:",o.data),i({kind:"warning",message:"Formato de resposta nÃ£o reconhecido do webhook"})):(console.log("â„¹ï¸ Nenhum agente encontrado"),i({kind:"info",message:"Nenhum agente encontrado"}))}catch(o){console.error("Erro ao carregar agentes:",o),i({kind:"error",message:"Erro ao carregar configuraÃ§Ãµes de agentes"}),f([])}finally{k(!1)}}async function V(){try{const o=await b("webhook/list-users",{method:"GET"});o.data&&Array.isArray(o.data)&&M(o.data)}catch(o){console.error("Erro ao carregar usuÃ¡rios:",o)}}async function g(){try{const o=await b("webhook/list-agente-atribuicoes",{method:"GET"});if(o.data){let s=[];Array.isArray(o.data)?s=o.data.map(a=>a.data||a):o.data.data&&(s=Array.isArray(o.data.data)?o.data.data:[o.data.data]),N(s),console.log("ğŸ“‹ AtribuiÃ§Ãµes carregadas:",s)}else console.log("âš ï¸ Nenhuma atribuiÃ§Ã£o encontrada ou formato invÃ¡lido"),N([])}catch(o){console.error("Erro ao carregar atribuiÃ§Ãµes:",o),N([])}}async function F(o,s){try{const a=await b("webhook/atribuir-agente-usuario",{method:"POST",data:{agente_id:o,usuario_id:s,atribuido_por:m?.id}});if(a.data&&a.data.success)i({kind:"success",message:"Agente atribuÃ­do com sucesso!"}),setTimeout(async()=>{await g(),console.log("ğŸ”„ AtribuiÃ§Ãµes recarregadas apÃ³s atribuiÃ§Ã£o")},500);else throw new Error("Falha na atribuiÃ§Ã£o")}catch(a){console.error("Erro ao atribuir agente:",a),i({kind:"error",message:"Erro ao atribuir agente"})}}async function I(o,s){try{const a=await b("webhook/remover-atribuicao-agente",{method:"POST",data:{agente_id:o,usuario_id:s}});if(a.data&&a.data.success)i({kind:"success",message:"AtribuiÃ§Ã£o removida com sucesso!"}),setTimeout(async()=>{await g(),console.log("ğŸ”„ AtribuiÃ§Ãµes recarregadas apÃ³s remoÃ§Ã£o")},500);else throw new Error("Falha na remoÃ§Ã£o")}catch(a){console.error("Erro ao remover atribuiÃ§Ã£o:",a),i({kind:"error",message:"Erro ao remover atribuiÃ§Ã£o"})}}function A(o,s){if(console.log(`ğŸ” Verificando atribuiÃ§Ã£o: agente ${o} para usuÃ¡rio ${s}`),console.log("ğŸ“‹ AtribuiÃ§Ãµes disponÃ­veis:",u),console.log("ğŸ“Š Tipo de atribuicoes:",typeof u,Array.isArray(u)),console.log("ğŸ“Š Tamanho do array:",u?.length),!Array.isArray(u))return console.log("âš ï¸ AtribuiÃ§Ãµes nÃ£o Ã© um array, retornando false"),!1;if(u.length===0)return console.log("âš ï¸ Array de atribuiÃ§Ãµes estÃ¡ vazio, retornando false"),!1;const a=u.some(l=>{console.log(`ğŸ” Comparando: agente ${l.agente_id} (${typeof l.agente_id}) === ${o} (${typeof o}) && usuario ${l.usuario_id} (${typeof l.usuario_id}) === ${s} (${typeof s})`);const h=l.agente_id==o,y=l.usuario_id==s;return console.log(`ğŸ” Resultado: agenteMatch=${h}, usuarioMatch=${y}`),h&&y});return console.log("âœ… EstÃ¡ atribuÃ­do:",a),a}function O(o){console.log("ğŸ” Abrindo modal de atribuiÃ§Ã£o para agente:",o),T(o),R(!0),g()}function $(){R(!1),T(null)}async function G(){console.log("ğŸ§ª Iniciando teste de atribuiÃ§Ãµes...");try{console.log("ğŸ“‹ 1. Verificando atribuiÃ§Ãµes atuais..."),await g(),console.log("ğŸ“‹ 2. Aguardando estado ser atualizado...");let o=0,s=!1;for(;o<10&&(await new Promise(a=>setTimeout(a,200)),s=A(65,6),console.log(`ğŸ“‹ Tentativa ${o+1}: isAtribuido = ${s}`),!s);)o++;if(console.log("âœ… UsuÃ¡rio 6 atribuÃ­do ao agente 65:",s),s)i({kind:"success",message:"Teste de atribuiÃ§Ã£o: SUCESSO! AtribuiÃ§Ã£o jÃ¡ existe e foi encontrada."});else{console.log("ğŸ“‹ 3. Criando atribuiÃ§Ã£o de teste..."),await F(65,6),await new Promise(l=>setTimeout(l,1e3)),console.log("ğŸ“‹ 4. Recarregando atribuiÃ§Ãµes..."),await g(),console.log("ğŸ“‹ 5. Aguardando estado ser atualizado apÃ³s criaÃ§Ã£o..."),o=0;let a=!1;for(;o<10&&(await new Promise(l=>setTimeout(l,200)),a=A(65,6),console.log(`ğŸ“‹ Tentativa ${o+1} (apÃ³s criaÃ§Ã£o): isAtribuido = ${a}`),!a);)o++;console.log("âœ… UsuÃ¡rio 6 atribuÃ­do ao agente 65 (apÃ³s criaÃ§Ã£o):",a),i({kind:a?"success":"warning",message:a?"Teste de atribuiÃ§Ã£o: SUCESSO! UsuÃ¡rio foi atribuÃ­do.":"Teste de atribuiÃ§Ã£o: FALHOU! UsuÃ¡rio nÃ£o foi atribuÃ­do."})}}catch(o){console.error("âŒ Erro no teste:",o),i({kind:"error",message:"Erro no teste de atribuiÃ§Ãµes"})}}const B=()=>{const o=Date.now().toString(36),s=Math.random().toString(36).substr(2,5);return`${o}${s}`.toUpperCase()},Z=o=>o.toLowerCase().replace(/\s+/g,"").replace(/[^a-z0-9]/g,"").substring(0,20);async function X(){if(!t.nome){i({kind:"error",message:"Nome do agente Ã© obrigatÃ³rio"});return}if(j){console.log("âš ï¸ RequisiÃ§Ã£o jÃ¡ em andamento, ignorando duplo clique");return}k(!0);try{if(x)await b("webhook/update-agente",{method:"POST",data:{id:x.id,...t,logged_user:{id:m?.id,name:m?.name,email:m?.mail}}}),i({kind:"success",message:"Agente atualizado com sucesso!"});else{const o=B(),s=Z(t.nome);console.log("ğŸš€ Criando agente com clonagem automÃ¡tica:",{agent_name:t.nome,agent_type:s,agent_id:o,user_id:m?.id});const a=await b("webhook/create-agente",{method:"POST",data:{action:"create",agent_name:t.nome,agent_type:s,agent_id:o,user_id:m?.id,descricao:t.descricao||"",icone:t.icone||"ğŸ¤–",cor:t.cor||"bg-blue-500",ativo:t.ativo!==void 0?t.ativo:!0,workflow_id:t.workflow_id||"",webhook_url:t.webhook_url||""}});if(console.log("âœ… Resposta da clonagem:",a),a.data&&a.data.success&&a.data.agentId)i({kind:"success",message:`Agente ${a.data.agentName||t.nome} criado com sucesso! ID: ${a.data.agentId}`}),console.log("ğŸ”„ REFRESH: Chamando loadAgentes() apÃ³s criaÃ§Ã£o bem-sucedida (nova estrutura)"),setTimeout(()=>{console.log("ğŸ”„ REFRESH: Executando loadAgentes() apÃ³s delay de 2s"),c()},2e3),setTimeout(()=>{console.log("ğŸ”„ REFRESH: Executando loadAgentes() apÃ³s delay de 5s (backup)"),c()},5e3);else if(a.data&&a.data.message==="Workflow was started")i({kind:"success",message:`Agente ${t.nome} criado com sucesso! Workflow foi iniciado automaticamente.`}),console.log("ğŸ”„ REFRESH: Chamando loadAgentes() apÃ³s criaÃ§Ã£o bem-sucedida (workflow started)"),setTimeout(()=>{console.log("ğŸ”„ REFRESH: Executando loadAgentes() apÃ³s delay de 2s"),c()},2e3),setTimeout(()=>{console.log("ğŸ”„ REFRESH: Executando loadAgentes() apÃ³s delay de 5s (backup)"),c()},5e3);else if(a.data&&(a.data.id||a.data.name))i({kind:"success",message:`Agente ${t.nome} criado com sucesso! Workflow "${a.data.name}" foi criado automaticamente.`}),console.log("ğŸ”„ REFRESH: Chamando loadAgentes() apÃ³s criaÃ§Ã£o bem-sucedida (dados completos)"),setTimeout(()=>{console.log("ğŸ”„ REFRESH: Executando loadAgentes() apÃ³s delay de 2s"),c()},2e3),setTimeout(()=>{console.log("ğŸ”„ REFRESH: Executando loadAgentes() apÃ³s delay de 5s (backup)"),c()},5e3);else if(a.data?.success){const l=a.data.workflows;l&&Object.values(l).forEach(h=>{if(h.webhook){const y=`https://n8n.code-iq.com.br/webhook/${h.webhook}`;W(`webhook/${h.webhook}`,y)}}),i({kind:"success",message:`Agente ${t.nome} criado com sucesso! 4 workflows foram criados automaticamente.`}),console.log("ğŸ”„ REFRESH: Chamando loadAgentes() apÃ³s criaÃ§Ã£o bem-sucedida (success flag)"),setTimeout(()=>{console.log("ğŸ”„ REFRESH: Executando loadAgentes() apÃ³s delay de 2s"),c()},2e3),setTimeout(()=>{console.log("ğŸ”„ REFRESH: Executando loadAgentes() apÃ³s delay de 5s (backup)"),c()},5e3)}else if(a.status===200&&a.data)i({kind:"success",message:`Agente ${t.nome} criado com sucesso! Workflow foi processado.`}),console.log("ğŸ”„ REFRESH: Chamando loadAgentes() apÃ³s criaÃ§Ã£o bem-sucedida"),setTimeout(()=>{console.log("ğŸ”„ REFRESH: Executando loadAgentes() apÃ³s delay de 2s"),c()},2e3),setTimeout(()=>{console.log("ğŸ”„ REFRESH: Executando loadAgentes() apÃ³s delay de 5s (backup)"),c()},5e3);else throw new Error("Falha na criaÃ§Ã£o automÃ¡tica do agente")}v(!1),w(null),z(),console.log("ğŸ”„ REFRESH: Executando refresh final apÃ³s criaÃ§Ã£o"),setTimeout(()=>{c()},3e3)}catch(o){console.error("Erro ao salvar agente:",o),i({kind:"error",message:"Erro ao criar agente automaticamente"})}finally{k(!1)}}async function J(o,s){if(confirm("Tem certeza que deseja excluir este agente?"))try{await b("webhook/delete-agente",{method:"POST",data:{id:o,agent_name:s,logged_user:{id:m?.id,name:m?.name,email:m?.mail}}}),i({kind:"success",message:"Agente excluÃ­do com sucesso!"}),c()}catch(a){console.error("Erro ao excluir agente:",a),i({kind:"error",message:"Erro ao excluir agente"})}}async function K(o){try{console.log("ğŸ” Testando conectividade do webhook:",o.webhook_url);const s=`https://n8n.code-iq.com.br/${o.webhook_url}`,a=await fetch(s,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({test:!0,ping:"connectivity_test"})});console.log("ğŸ” RequisiÃ§Ã£o enviada para:",s),i({kind:"success",message:`âœ… Webhook ${o.nome} estÃ¡ ativo!`})}catch(s){console.error("Erro ao testar webhook:",s),s.message.includes("Failed to fetch")||s.message.includes("ERR_FAILED")?i({kind:"error",message:`âŒ Webhook ${o.nome} nÃ£o estÃ¡ ativo`}):i({kind:"error",message:`âŒ Webhook ${o.nome} com erro de conectividade`})}}function z(){r({nome:"",workflow_id:"",webhook_url:"",descricao:"",icone:"ğŸ¤–",cor:"bg-blue-500",ativo:!0})}function Q(o){console.log("ğŸ” Editando agente:",o),w(o),r(o),v(!0)}function P(){v(!1),n(!1),w(null),z()}return d.useEffect(()=>{c(),V(),g()},[]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-foreground mb-2",children:"ConfiguraÃ§Ã£o de Agentes"}),e.jsx("p",{className:"text-muted-foreground",children:"Gerencie os agentes automatizados do sistema"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>v(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Criar Agente Automaticamente"]}),e.jsx("button",{onClick:G,className:"btn btn-outline flex items-center gap-2",children:"ğŸ§ª Testar AtribuiÃ§Ãµes"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6 auto-rows-max",children:j?e.jsxs("div",{className:"col-span-full text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Carregando agentes..."})]}):C.length===0?e.jsxs("div",{className:"col-span-full text-center py-8",children:[e.jsx(te,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Nenhum agente configurado"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:'Clique em "Criar Agente Automaticamente" para comeÃ§ar'})]}):C.map(o=>e.jsxs("div",{className:"card min-h-[450px] flex flex-col hover:shadow-lg transition-shadow duration-200 overflow-hidden",children:[e.jsx("div",{className:"card-header pb-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("span",{className:"text-3xl flex-shrink-0",children:o.icone}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-lg truncate",children:o.nome}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:o.descricao||"Agente automatizado"}),(()=>{const s=u.filter(a=>a.agente_id===o.id);return s.length>0?e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),e.jsxs("span",{className:"text-xs text-green-600 font-medium truncate",children:[s.length," usuÃ¡rio",s.length>1?"s":""," atribuÃ­do",s.length>1?"s":""]})]}):null})()]})]}),e.jsxs("div",{className:"flex flex-col gap-2 flex-shrink-0",children:[e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap ${o.ativo?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400"}`,children:o.ativo?"Ativo":"Inativo"}),(()=>{const s=u.filter(a=>a.agente_id===o.id);return s.length>0?e.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400 whitespace-nowrap",children:[s.length," atribuÃ­do",s.length>1?"s":""]}):e.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-500 dark:bg-gray-800 dark:text-gray-400 whitespace-nowrap",children:"Sem atribuiÃ§Ãµes"})})()]})]})}),e.jsxs("div",{className:"card-content space-y-4 flex-1",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Workflow ID"}),e.jsx("div",{className:"text-sm font-mono bg-muted px-2 py-1 rounded truncate",children:o.workflow_id||"NÃ£o definido"})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Cor"}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:`w-4 h-4 rounded flex-shrink-0 ${o.cor||"bg-gray-500"}`}),e.jsx("span",{className:"text-sm truncate",children:(()=>{const s=o.cor?.replace("bg-","").replace("-500","").replace("-600","")||"gray";return{red:"Vermelho",pink:"Rosa",orange:"Laranja",yellow:"Amarelo",lime:"Lima",green:"Verde",emerald:"Esmeralda",teal:"Verde Azulado",cyan:"Ciano",blue:"Azul",indigo:"Ãndigo",purple:"Roxo",violet:"Violeta",fuchsia:"Fuchsia",slate:"Cinza",gray:"Cinza",zinc:"Zinco",neutral:"Neutro",stone:"Pedra",amber:"Ã‚mbar"}[s]||s})()})]})]})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Webhook URL"}),e.jsx("div",{className:"text-xs font-mono bg-muted px-2 py-1 rounded truncate",children:o.webhook_url||"NÃ£o definido"})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0"}),e.jsx("div",{className:"text-sm font-semibold text-foreground truncate",children:"ğŸ‘¥ AtribuÃ­do para:"})]}),(()=>{const s=u.filter(a=>a.agente_id===o.id);return s.length===0?e.jsx("div",{className:"text-sm text-muted-foreground italic bg-muted/50 px-3 py-2 rounded-lg",children:"Nenhum usuÃ¡rio atribuÃ­do"}):e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:s.map((a,l)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-muted/30 rounded-lg min-w-0",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm text-foreground truncate",children:a.usuario_nome||`UsuÃ¡rio ${a.usuario_id}`}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:a.usuario_id||"Sem ID"})]})]},l))})})()]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-4 mt-auto border-t",children:[e.jsxs("button",{onClick:()=>K(o),className:"btn btn-sm btn-outline flex items-center justify-center gap-2 hover:bg-blue-50 hover:border-blue-300 min-w-0",title:"Testar Webhook",children:[e.jsx(se,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Testar"})]}),e.jsxs("button",{onClick:()=>Q(o),className:"btn btn-sm btn-outline flex items-center justify-center gap-2 hover:bg-yellow-50 hover:border-yellow-300 min-w-0",title:"Editar Agente",children:[e.jsx(re,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Editar"})]}),e.jsxs("button",{onClick:()=>O(o),className:"btn btn-sm btn-primary flex items-center justify-center gap-2 hover:bg-blue-600 min-w-0",title:"Atribuir Agente",children:[e.jsx(E,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Atribuir"})]}),e.jsxs("button",{onClick:()=>J(o.id,o.nome),className:"btn btn-sm btn-destructive flex items-center justify-center gap-2 hover:bg-red-600 min-w-0",title:"Excluir Agente",children:[e.jsx(ne,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Excluir"})]})]})]})]},o.id))}),L&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background border rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:x?"Editar Agente":"Criar Agente Automaticamente"}),e.jsx("button",{onClick:P,className:"text-muted-foreground hover:text-foreground",children:e.jsx(H,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:o=>{o.preventDefault(),X()},className:"space-y-4",children:[!x&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-blue-600 text-xl",children:"ğŸš€"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-1",children:"CriaÃ§Ã£o AutomÃ¡tica de Agente"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Ao criar um novo agente, o sistema irÃ¡ automaticamente:"}),e.jsxs("ul",{className:"text-sm text-blue-700 mt-2 space-y-1",children:[e.jsx("li",{children:"â€¢ Gerar um ID Ãºnico para o agente"}),e.jsx("li",{children:"â€¢ Criar 4 workflows essenciais (Start, Stop, Status, Lista)"}),e.jsx("li",{children:"â€¢ Configurar webhooks especÃ­ficos"}),e.jsx("li",{children:'â€¢ Organizar na estrutura "Elleve Consorcios"'})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Nome do Agente *"}),e.jsx("input",{type:"text",value:t.nome||"",onChange:o=>r({...t,nome:o.target.value}),className:"input w-full",placeholder:"ex: Agente JoÃ£o",required:!0}),!x&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"O sistema gerarÃ¡ automaticamente o Workflow ID e Webhook URL"})]}),x&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Workflow ID *"}),e.jsx("input",{type:"text",value:t.workflow_id||"",onChange:o=>r({...t,workflow_id:o.target.value}),className:"input w-full",placeholder:"ex: eBcColwirndBaFZX",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Webhook URL *"}),e.jsx("input",{type:"text",value:t.webhook_url||"",onChange:o=>r({...t,webhook_url:o.target.value}),className:"input w-full",placeholder:"ex: webhook/agente1",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Ãcone"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:t.icone||"",onChange:o=>r({...t,icone:o.target.value}),className:"input flex-1",placeholder:"ex: ğŸ¤–"}),e.jsx("button",{type:"button",onClick:()=>n(!S),className:"btn btn-outline px-3",title:"Escolher Ã­cone",children:"ğŸ¨"})]}),S&&e.jsxs("div",{className:"mt-3 p-4 border rounded-lg bg-muted/50",children:[e.jsx("h4",{className:"text-sm font-medium mb-3",children:"Escolha um Ã­cone:"}),e.jsxs("div",{className:"grid grid-cols-8 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ¤–"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"RobÃ´",children:"ğŸ¤–"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ‘¾"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Alien",children:"ğŸ‘¾"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ¦¾"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"BraÃ§o RobÃ³tico",children:"ğŸ¦¾"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ¦¿"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Perna RobÃ³tica",children:"ğŸ¦¿"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ§ "}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"CÃ©rebro IA",children:"ğŸ§ "}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"âš¡"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Energia",children:"âš¡"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ”®"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Cristal",children:"ğŸ”®"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ¯"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Alvo",children:"ğŸ¯"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ’¬"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Chat",children:"ğŸ’¬"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ“"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Telefone",children:"ğŸ“"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ“§"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Email",children:"ğŸ“§"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ“±"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Celular",children:"ğŸ“±"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸŒ"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Web",children:"ğŸŒ"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ”—"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Link",children:"ğŸ”—"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ“Š"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Analytics",children:"ğŸ“Š"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ“ˆ"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"GrÃ¡fico",children:"ğŸ“ˆ"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸš€"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Foguete",children:"ğŸš€"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"âš™ï¸"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Engrenagem",children:"âš™ï¸"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ”§"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Ferramenta",children:"ğŸ”§"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ› ï¸"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Ferramentas",children:"ğŸ› ï¸"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ”"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Busca",children:"ğŸ”"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ’¡"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Ideia",children:"ğŸ’¡"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸª"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Show",children:"ğŸª"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ­"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Teatro",children:"ğŸ­"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ”¥"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Fogo",children:"ğŸ”¥"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"â„ï¸"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Gelo",children:"â„ï¸"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"â­"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Estrela",children:"â­"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸŒŸ"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Estrela Brilhante",children:"ğŸŒŸ"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ’"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Diamante",children:"ğŸ’"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ†"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"TrofÃ©u",children:"ğŸ†"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ–ï¸"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Medalha",children:"ğŸ–ï¸"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"âœ…"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Sucesso",children:"âœ…"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ¨"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Arte",children:"ğŸ¨"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸµ"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"MÃºsica",children:"ğŸµ"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ®"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Game",children:"ğŸ®"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ²"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Dado",children:"ğŸ²"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸª"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Show",children:"ğŸª"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ­"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Teatro",children:"ğŸ­"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ§"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Fone",children:"ğŸ§"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ¬"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Filme",children:"ğŸ¬"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ¤"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Microfone",children:"ğŸ¤"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ¸"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Guitarra",children:"ğŸ¸"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ¹"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Piano",children:"ğŸ¹"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ¥³"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Festa",children:"ğŸ¥³"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ¤©"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Impressionado",children:"ğŸ¤©"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸ˜"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Cool",children:"ğŸ˜"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸš€"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"Foguete",children:"ğŸš€"}),e.jsx("button",{type:"button",onClick:()=>{r({...t,icone:"ğŸŒŒ"}),n(!1)},className:"p-2 text-2xl hover:bg-background rounded border",title:"GalÃ¡xia",children:"ğŸŒŒ"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Cor CSS"}),e.jsxs("select",{value:t.cor,onChange:o=>r({...t,cor:o.target.value}),className:"input w-full",children:[e.jsx("option",{value:"bg-red-500",children:"ğŸ”´ Vermelho"}),e.jsx("option",{value:"bg-red-600",children:"ğŸ”´ Vermelho Escuro"}),e.jsx("option",{value:"bg-pink-500",children:"ğŸŒ¸ Rosa"}),e.jsx("option",{value:"bg-pink-600",children:"ğŸŒ¸ Rosa Escuro"}),e.jsx("option",{value:"bg-orange-500",children:"ğŸŸ  Laranja"}),e.jsx("option",{value:"bg-orange-600",children:"ğŸŸ  Laranja Escuro"}),e.jsx("option",{value:"bg-yellow-500",children:"ğŸŸ¡ Amarelo"}),e.jsx("option",{value:"bg-yellow-600",children:"ğŸŸ¡ Amarelo Escuro"}),e.jsx("option",{value:"bg-lime-500",children:"ğŸŸ¢ Lima"}),e.jsx("option",{value:"bg-lime-600",children:"ğŸŸ¢ Lima Escuro"}),e.jsx("option",{value:"bg-green-500",children:"ğŸŸ¢ Verde"}),e.jsx("option",{value:"bg-green-600",children:"ğŸŸ¢ Verde Escuro"}),e.jsx("option",{value:"bg-emerald-500",children:"ğŸ’š Esmeralda"}),e.jsx("option",{value:"bg-emerald-600",children:"ğŸ’š Esmeralda Escuro"}),e.jsx("option",{value:"bg-teal-500",children:"ğŸŸ¦ Verde Azulado"}),e.jsx("option",{value:"bg-teal-600",children:"ğŸŸ¦ Verde Azulado Escuro"}),e.jsx("option",{value:"bg-cyan-500",children:"ğŸ”µ Ciano"}),e.jsx("option",{value:"bg-cyan-600",children:"ğŸ”µ Ciano Escuro"}),e.jsx("option",{value:"bg-blue-500",children:"ğŸ”µ Azul"}),e.jsx("option",{value:"bg-blue-600",children:"ğŸ”µ Azul Escuro"}),e.jsx("option",{value:"bg-indigo-500",children:"ğŸŸ£ Ãndigo"}),e.jsx("option",{value:"bg-indigo-600",children:"ğŸŸ£ Ãndigo Escuro"}),e.jsx("option",{value:"bg-purple-500",children:"ğŸŸ£ Roxo"}),e.jsx("option",{value:"bg-purple-600",children:"ğŸŸ£ Roxo Escuro"}),e.jsx("option",{value:"bg-violet-500",children:"ğŸ’œ Violeta"}),e.jsx("option",{value:"bg-violet-600",children:"ğŸ’œ Violeta Escuro"}),e.jsx("option",{value:"bg-fuchsia-500",children:"ğŸŸ£ Fuchsia"}),e.jsx("option",{value:"bg-fuchsia-600",children:"ğŸŸ£ Fuchsia Escuro"}),e.jsx("option",{value:"bg-slate-500",children:"âš« Cinza"}),e.jsx("option",{value:"bg-slate-600",children:"âš« Cinza Escuro"}),e.jsx("option",{value:"bg-gray-500",children:"âš« Cinza MÃ©dio"}),e.jsx("option",{value:"bg-gray-600",children:"âš« Cinza MÃ©dio Escuro"}),e.jsx("option",{value:"bg-zinc-500",children:"âš« Zinco"}),e.jsx("option",{value:"bg-zinc-600",children:"âš« Zinco Escuro"}),e.jsx("option",{value:"bg-neutral-500",children:"âš« Neutro"}),e.jsx("option",{value:"bg-neutral-600",children:"âš« Neutro Escuro"}),e.jsx("option",{value:"bg-stone-500",children:"ğŸŸ¤ Pedra"}),e.jsx("option",{value:"bg-stone-600",children:"ğŸŸ¤ Pedra Escuro"}),e.jsx("option",{value:"bg-amber-500",children:"ğŸŸ¡ Ã‚mbar"}),e.jsx("option",{value:"bg-amber-600",children:"ğŸŸ¡ Ã‚mbar Escuro"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"DescriÃ§Ã£o"}),e.jsx("textarea",{value:t.descricao||"",onChange:o=>r({...t,descricao:o.target.value}),className:"input w-full",rows:3,placeholder:"DescriÃ§Ã£o do agente..."})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.ativo,onChange:o=>r({...t,ativo:o.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm font-medium",children:"Agente ativo"})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:P,className:"btn btn-outline",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:j,className:"btn btn-primary flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ie,{className:"w-4 h-4"}),j?"Processando...":x?"Atualizar":"Criar Automaticamente"," Agente"]})]})]})]})}),q&&p&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background border rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:["Atribuir Agente: ",p.nome]}),e.jsx("button",{onClick:$,className:"text-muted-foreground hover:text-foreground",children:e.jsx(H,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-blue-600 text-xl",children:"ğŸ‘¥"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-1",children:"AtribuiÃ§Ã£o de Agentes"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Selecione os usuÃ¡rios que terÃ£o acesso a este agente. Apenas usuÃ¡rios com permissÃ£o de execuÃ§Ã£o de agentes poderÃ£o utilizÃ¡-lo."})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"UsuÃ¡rios DisponÃ­veis"}),_.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(E,{className:"w-12 h-12 mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"Nenhum usuÃ¡rio encontrado"})]}):e.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-60 overflow-y-auto",children:_.map(o=>{const s=A(p.id,o.id);return e.jsxs("div",{className:`flex items-center justify-between p-3 border rounded-lg transition-colors ${s?"bg-green-100 border-green-300 shadow-sm":"bg-white border-gray-200 hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${s?"bg-green-200 text-green-700":"bg-gray-200 text-gray-700"}`,children:s?e.jsx(U,{className:"w-4 h-4"}):e.jsx(E,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${s?"text-green-800":"text-gray-900"}`,children:o.nome}),e.jsx("p",{className:`text-sm ${s?"text-green-600":"text-gray-600"}`,children:o.email})]})]}),e.jsx("div",{className:"flex gap-2",children:s?e.jsxs("button",{onClick:()=>I(p.id,o.id),className:"btn btn-sm btn-destructive flex items-center gap-1",title:"Remover AtribuiÃ§Ã£o",children:[e.jsx(de,{className:"w-3 h-3"}),"Remover"]}):e.jsxs("button",{onClick:()=>F(p.id,o.id),className:"btn btn-sm btn-primary flex items-center gap-1",title:"Atribuir Agente",children:[e.jsx(U,{className:"w-3 h-3"}),"Atribuir"]})})]},o.id)})})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsx("button",{onClick:$,className:"btn btn-outline",children:"Fechar"})})]})]})})]})}export{pe as default};
