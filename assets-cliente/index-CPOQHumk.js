import{l as x,m as E,a as I,r as i,W as N,j as e,k as V}from"./index-CJnD_gLK.js";import{S as L}from"./search-CgJIrsuZ.js";import{S as $}from"./save-D0EATYqx.js";import{R as M}from"./refresh-cw-Co52wWG9.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],F=x("check",q);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],B=x("copy",H);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],G=x("external-link",D);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],K=x("funnel",z);function W(c){try{return new URL(c),!0}catch{return!1}}const h={Agentes:["webhook/agente1","webhook/parar-agente","webhook/status-agente","webhook/agente-fria","webhook/agente-followup","webhook/agente-suporte","webhook-test/agente-teste","webhook/agente-teste","webhook-agente2","agente2"],Usuários:["webhook/list-users","webhook/list-company"],Perfis:["webhook/list-profile","webhook/list-permission","webhook/create-profile","webhook/edit-profile","webhook/assign-user-profiles","webhook/delete-profile"],Upload:["webhook-upload","webhook-controle-agente"],Saudações:["webhook-deletar-saudacao","webhook-agente-recebimento"]};function P(c){const p=Object.keys(c),l=[...N,...Object.entries(c).map(([a,g])=>({id:a,name:`Webhook ${a.split("/").pop()}`,url:g}))].filter(a=>a.id.toLowerCase().includes("agente")||a.name.toLowerCase().includes("agente")).map(a=>a.id);return{...h,Agentes:[...h.Agentes,...p,...l]}}function Z(){const{urls:c,setAll:p,addWebhook:f}=E(),l=I(s=>s.push),[a,g]=i.useState({...c}),[n,b]=i.useState(""),[d,y]=i.useState("Todos"),[S,w]=i.useState(null),[j,A]=i.useState({});i.useEffect(()=>{async function s(){try{const o=await V("webhook/list-agentes",{method:"GET"});if(o.data&&Array.isArray(o.data)&&o.data.length>0){const t=o.data[0],r=t.data||t["data	"]||t["data "];if(r&&Array.isArray(r)){const u={};r.forEach(O=>{const k=O.json;if(k.webhook_url){const v=k.webhook_url,C=`https://n8n.code-iq.com.br/${k.webhook_url}`;u[v]=C,c[v]||f(v,C)}}),A(u)}}}catch(o){console.error("Erro ao carregar webhooks dos agentes:",o)}}s()},[c,f]);const m=i.useMemo(()=>{let s=N;const o=Object.entries(j).map(([t,r])=>({id:t,name:`Webhook ${t.split("/").pop()}`,url:r}));if(s=[...s,...o],d!=="Todos"){const r=P(j)[d];s=s.filter(u=>r.includes(u.id))}if(n&&n.trim()!==""){const t=n.toLowerCase().trim();s=s.filter(r=>r.name.toLowerCase().includes(t)||r.id.toLowerCase().includes(t))}return s},[n,d,j]);function T(s,o){g(t=>({...t,[s]:o}))}function U(){if(!Object.values(a).every(W)){l({kind:"error",message:"Há URLs inválidas. Verifique e tente novamente."});return}try{p(a),l({kind:"success",message:"Webhooks salvos com sucesso!"})}catch{l({kind:"error",message:"Falha ao salvar webhooks."})}}function R(s,o){navigator.clipboard.writeText(s),w(o),setTimeout(()=>w(null),2e3),l({kind:"info",message:"URL copiada para a área de transferência!"})}function _(s){for(const[o,t]of Object.entries(h))if(t.includes(s))return o;return"Outros"}return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Configurar Webhooks"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Gerencie as URLs dos webhooks do sistema"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[m.length," de ",N.length," webhooks"]}),n&&e.jsxs("span",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded",children:['Buscando: "',n,'"']})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Buscar webhook por nome ou ID...",value:n,onChange:s=>b(s.target.value),className:"input pl-10 w-full",autoComplete:"off"}),n&&e.jsx("button",{onClick:()=>b(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",title:"Limpar busca",children:"×"})]})}),e.jsx("div",{className:"md:w-48",children:e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsxs("select",{value:d,onChange:s=>y(s.target.value),className:"input pl-10 w-full",children:[e.jsx("option",{value:"Todos",children:"Todas as Categorias"}),Object.keys(h).map(s=>e.jsx("option",{value:s,children:s},s))]})]})}),e.jsxs("button",{onClick:U,className:"btn btn-primary flex items-center gap-2 px-6",children:[e.jsx($,{className:"w-4 h-4"}),"Salvar Alterações"]})]})})}),e.jsx("div",{className:"space-y-4",children:m.length===0?e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content text-center py-12",children:e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx(L,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Nenhum webhook encontrado"}),e.jsx("p",{className:"text-sm",children:"Tente ajustar os filtros ou termo de busca"})]})})}):m.map(s=>{const o=_(s.id),t=a[s.id]&&a[s.id].trim()!=="",r=t?W(a[s.id]):!0;return e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"flex items-start gap-4",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-primary/10 text-primary",children:o}),t&&e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${r?"bg-success/10 text-success":"bg-destructive/10 text-destructive"}`,children:r?"URL Válida":"URL Inválida"})]}),e.jsx("h3",{className:"font-medium text-foreground mb-1",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono mb-3",children:s.id}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"url",placeholder:"https://exemplo.com/webhook/endpoint",value:a[s.id]??"",onChange:u=>T(s.id,u.target.value),className:`input w-full pr-20 ${t&&!r?"border-destructive focus:border-destructive":""}`}),e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:t&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>R(a[s.id],s.id),className:"p-1 hover:bg-accent rounded transition-colors",title:"Copiar URL",children:S===s.id?e.jsx(F,{className:"w-4 h-4 text-success"}):e.jsx(B,{className:"w-4 h-4 text-muted-foreground"})}),e.jsx("button",{onClick:()=>window.open(a[s.id],"_blank"),className:"p-1 hover:bg-accent rounded transition-colors",title:"Abrir URL",children:e.jsx(G,{className:"w-4 h-4 text-muted-foreground"})})]})})]}),t&&!r&&e.jsx("p",{className:"text-xs text-destructive mt-2",children:"URL inválida. Verifique o formato."})]})})})},s.id)})}),m.length>0&&e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",m.length," webhook",m.length!==1?"s":"",n&&` para "${n}"`,d!=="Todos"&&` na categoria "${d}"`]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:()=>{b(""),y("Todos")},className:"btn btn-outline flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"Limpar Filtros"]})})]})})})]})}export{Z as default};
